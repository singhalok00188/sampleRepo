#
# Specify the vcenter server, vcenter Server username and vcenter Server password
$vcenter="10.85.2.51"
$vcenterUser="root"
$vcenterUserPassword="MotionDragon987"
#]
# Specify number of VMs you want to create
$vm_count = "10"
#
# Specify number of VM CPUs
$numcpu ="1"
#
# Specify number of VM MB RAM
$MBram = "16"
#
# Specify number of VM disk size (in MB)
$MBguestdisk = "4"
#
# Specify VM disk type, available option are Thin, Thick, EagerZeroedThick
$Typeguestdisk = "Thin"
#
# Specify VM Guest OS
$guestOS = "winNetStandardGuest"
#
# Specify vcenter Server datastore
$ds = "datastore1"
#
# Specify the Vsphere cluster
$Cluster ="IP"
#
# Specify VM Name to the left of -sign
$VM_prefix = "VM-"
#
# End of user Input Parameter
----------------------------------------------------------------
Connect-VIServer $VCenter 
    New-VM -Name $ComputerName -GuestId $GuestOS -VMHost $VMHost -Version v11 -DiskGB $DiskSpace -Datastore $Datastore -MemoryGB $Memory -NumCpu $CPU -NetworkName $NetworkName -CD 
    Get-VM -Name $ComputerName | Get-CDDrive | Set-CDDrive -IsoPath "[$Datastore] $LiteTouchPath" -Confirm:$false -StartConnected:$true 
    Start-VM -VM $ComputerName -Confirm:$False 
    Start-Sleep -Seconds 60
    Get-CDDrive -VM $ComputerName | Set-CDDrive -NoMedia -Confirm:$False